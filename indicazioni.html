<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Display navigation directions</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js"></script>
    <script src='https://unpkg.com/@turf/turf@6/turf.min.js'></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div id="map_navigazione"></div>

    <div class="controls-profile-switcher">
        <div class="profile-indicazioni walking active">
            <div class="icone-indicazioni walking-icon">
                <img class="walk-man" src="img/walk-man-active.svg" alt="walk-man" />
            </div>
            <p class="hyper txt-indicazioni duration-walking">- min</p>
        </div>
        
        <div class="profile-indicazioni cycling">
            <div class="icone-indicazioni cycling-icon">
                <img class="cycling-man" src="img/cycle-man.svg" alt="cycle-man" />
            </div>
            <p class="hyper txt-indicazioni duration-cycling">- min</p>
        </div>
        <div class="profile-indicazioni scooter">
            <div class="icone-indicazioni scooter-icon">
                <img class="scooter" src="img/scooter.svg" alt="scooter" />
            </div>
            <p class="hyper txt-indicazioni duration-scooter">- min</p>
        </div>
        <div class="selector-container">
            <div class="selector"></div>
        </div>
    </div>

    <!-- test mode -------------------------------------------------->
    <div class="overlay">
        <button id="mouse"><p class="hyper-bold" style="margin: 0;">Test Mode</p></button>
    </div>

    <div class="div_verifica_dentro_fuori" style="top:75% !important"><p class="dentro_fuori">loading</p></div>
    <!-- test mode -------------------------------------------------->


    <div class="destinazione_raggiunta not-visible">
        <div class="close-button-arrivato">
            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="19" viewBox="0 0 21 19" fill="none">
                <path d="M11.3986 9.5L20 17.973L18.973 19L10.5 10.3986L2.02703 19L1 17.973L9.60135 9.5L1 1.02703L2.02703 0L10.5 8.60135L18.973 0L20 1.02703L11.3986 9.5Z" fill="black"/>
            </svg>
        </div>
        <div class="pin-map-container">
            <svg class="pin-map" xmlns="http://www.w3.org/2000/svg" width="16" height="23" viewBox="0 0 16 23" fill="none">
                <mask id="path-1-outside-1_239_1480" maskUnits="userSpaceOnUse" x="0.5" y="0.5" width="15" height="22" fill="black">
                <rect fill="white" x="0.5" y="0.5" width="15" height="22"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2.31006 11.1462L8.00003 21.5L13.69 11.1261C14.2209 10.168 14.4997 9.09052 14.5 7.99499C14.4968 5.27744 12.8045 2.84851 10.257 1.90489C7.70953 0.961272 4.84411 1.702 3.07251 3.76213C1.30091 5.82226 0.996824 8.76725 2.31006 11.1462ZM8 9C9.10457 9 10 8.10457 10 7C10 5.89543 9.10457 5 8 5C6.89543 5 6 5.89543 6 7C6 8.10457 6.89543 9 8 9Z"/>
                </mask>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M2.31006 11.1462L8.00003 21.5L13.69 11.1261C14.2209 10.168 14.4997 9.09052 14.5 7.99499C14.4968 5.27744 12.8045 2.84851 10.257 1.90489C7.70953 0.961272 4.84411 1.702 3.07251 3.76213C1.30091 5.82226 0.996824 8.76725 2.31006 11.1462ZM8 9C9.10457 9 10 8.10457 10 7C10 5.89543 9.10457 5 8 5C6.89543 5 6 5.89543 6 7C6 8.10457 6.89543 9 8 9Z" fill="#FFF500"/>
                <path d="M8.00003 21.5L7.12365 21.9816L8.87681 21.9809L8.00003 21.5ZM2.31006 11.1462L3.18645 10.6645L3.18552 10.6629L2.31006 11.1462ZM13.69 11.1261L12.8153 10.6415L12.8132 10.6452L13.69 11.1261ZM14.5 7.99499L15.5 7.99529L15.5 7.9938L14.5 7.99499ZM10.257 1.90489L9.90969 2.84263L10.257 1.90489ZM3.07251 3.76213L3.83072 4.41415L3.07251 3.76213ZM8.87642 21.0184L3.18644 10.6645L1.43368 11.6278L7.12365 21.9816L8.87642 21.0184ZM12.8132 10.6452L7.12326 21.0191L8.87681 21.9809L14.5668 11.6071L12.8132 10.6452ZM13.5 7.99468C13.4997 8.92076 13.2641 9.83155 12.8153 10.6415L14.5647 11.6108C15.1778 10.5044 15.4996 9.26027 15.5 7.99529L13.5 7.99468ZM9.90969 2.84263C12.0651 3.64103 13.4973 5.69633 13.5 7.99617L15.5 7.9938C15.4963 4.85855 13.5439 2.05599 10.6044 0.967155L9.90969 2.84263ZM3.83072 4.41415C5.32981 2.6709 7.75429 2.04425 9.90969 2.84263L10.6044 0.967155C7.66477 -0.121704 4.35841 0.733097 2.31431 3.11012L3.83072 4.41415ZM3.18552 10.6629C2.07418 8.6497 2.33156 6.15747 3.83072 4.41415L2.31431 3.11012C0.270267 5.48706 -0.0805373 8.88481 1.4346 11.6294L3.18552 10.6629ZM9 7C9 7.55228 8.55228 8 8 8V10C9.65685 10 11 8.65685 11 7H9ZM8 6C8.55228 6 9 6.44772 9 7H11C11 5.34315 9.65685 4 8 4V6ZM7 7C7 6.44772 7.44772 6 8 6V4C6.34315 4 5 5.34315 5 7H7ZM8 8C7.44772 8 7 7.55228 7 7H5C5 8.65685 6.34315 10 8 10V8Z" fill="black" mask="url(#path-1-outside-1_239_1480)"/>
                <circle cx="8" cy="7" r="1.5" stroke="black"/>
            </svg>
        </div>
        <h5 class="firs txt-sei-arrivato">SEI GIUNT* A DESTINAZIONE!</h5>
    </div>

    <a href="#"> <svg class="menu-button" xmlns="http://www.w3.org/2000/svg" width="42" height="30" viewBox="0 0 42 27" fill="none">
        <rect x="1" y="1" width="40" height="4px" fill="#FFF500" stroke="black"/>
        <rect x="1" y="12" width="40" height="4px" fill="#FFF500" stroke="black"/>
        <rect x="1" y="23" width="40" height="4px" fill="#FFF500" stroke="black"/>
    </svg></a>

    <a href="index.html"><svg class="logo" xmlns="http://www.w3.org/2000/svg" width="102" height="28" viewBox="0 0 102 28" fill="none">
        <path d="M70.0344 0H72.8344V28H70.0344V0ZM71.4344 23.64H92.6744V28H71.4344V23.64ZM71.4344 0H99.7544V4.36H71.4344V0ZM98.3544 0H101.154V11.6H98.3544V0Z" fill="black"/>
        <path d="M35.3391 0H38.1391V28H35.3391V0ZM50.4191 18.48H53.2191V28H50.4191V18.48ZM36.7391 16.28H66.4591V20.64H36.7391V16.28ZM36.7391 0H65.0591V4.36H36.7391V0ZM63.6591 0H66.4591V18.48H63.6591V0Z" fill="black"/>
        <path d="M28.92 0H31.72V28H28.92V0ZM0.800003 0H3.6V28H0.800003V0ZM2.2 9H30.32V13.36H2.2V9ZM2.2 0H30.32V4.36H2.2V0Z" fill="black"/>
        </svg>
    </a>


    <!------------------------------------------------------------------------------------------ menu ---------------------------------------->

    <div class="div-menu">
        <a href="#">
            <svg class="close-button" xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25" fill="none">
                <path d="M24 25L24 20.3329L4.20775 13.3589L4.20775 11.6406L24 4.66783L24 0L-4.60484e-07 8.4498L-1.16877e-06 16.5517L24 25Z" fill="black"/>
            </svg>
        </a>

        <div class="container-fluid container-content-menu">
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu d-flex justify-content-center">
                <a class="link-b text-center m-0" href="#">
                    <h4 class="firs">LOGIN<td><nobr> &nbsp;></nobr></td></h4>
                </a>
            </div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu d-flex justify-content-center">
                <a class="link-b text-center m-0" href="#">
                    <h4 class="firs">ABOUT<td><nobr> &nbsp;></nobr></td></h4>
                </a>
            </div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu"></div>
        </div>

        <div class="container-fluid container-mura-menu">
            <div class="row row-mura-menu"></div>
            <div class="row row-mura-menu">
                <div class="col-11 d-flex align-items-end">
                    <div class="mura-menu-o"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-10"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-10"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-10"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
                <div class="col-9">
                    <div class="mura-menu-o"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
            <div class="row row-mura-menu">
                <div class="col-1"></div>
                <div class="col-1 d-flex justify-content-end">
                    <div class="mura-menu-v"></div>
                </div>
            </div>
        </div>
    </div>





    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.2.0/mapbox-gl-directions.js"></script>
    <script src="anime-master/lib/anime.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script>

        var user_lat;
        var user_lng;

        var id_posizione_aggiornata;

        var check_destinazione = false;
        var destinazione = { latitude: 43.91187814893709, longitude: 12.91044693538976 }    

        let options;

        const area_destinazione = turf.polygon([[
                [
                12.910327638741819,
                43.91198433533337
                ],
                [
                12.910302189125149,
                43.91198343463602
                ],
                [
                12.91027698460449,
                43.91198074121824
                ],
                [
                12.910252267915363,
                43.91197628101937
                ],
                [
                12.910228277095026,
                43.91197009699397
                ],
                [
                12.91020524318997,
                43.911962248698075
                ],
                [
                12.910183388030758,
                43.911952811715736
                ],
                [
                12.910162922095605,
                43.91194187693096
                ],
                [
                12.910144042483324,
                43.91192954965252
                ],
                [
                12.910126931015126,
                43.91191594859965
                ],
                [
                12.910111752483578,
                43.911901204758756
                ],
                [
                12.91009865306557,
                43.9118854601219
                ],
                [
                12.910087758914571,
                43.911868866319246
                ],
                [
                12.910079174945748,
                43.91185158315885
                ],
                [
                12.910072983825634,
                43.911833777087494
                ],
                [
                12.910069245176064,
                43.9118156195878
                ],
                [
                12.910067995000082,
                43.911797285526625
                ],
                [
                12.910069245335269,
                43.911778951471106
                ],
                [
                12.910072984137917,
                43.91176079398813
                ],
                [
                12.910079175399115,
                43.91174298794393
                ],
                [
                12.910087759491597,
                43.911725704820086
                ],
                [
                12.91009865374408,
                43.91170911106198
                ],
                [
                12.910111753237501,
                43.911693366475944
                ],
                [
                12.910126931815483,
                43.91167862269019
                ],
                [
                12.910144043299363,
                43.911665021694674
                ],
                [
                12.910162922895966,
                43.911652694473574
                ],
                [
                12.910183388784679,
                43.91164175974393
                ],
                [
                12.91020524386848,
                43.91163232281242
                ],
                [
                12.910228277672052,
                43.911624474561066
                ],
                [
                12.910252268368732,
                43.91161829057221
                ],
                [
                12.910276984916775,
                43.91161383040051
                ],
                [
                12.91030218928435,
                43.911611136999454
                ],
                [
                12.910327638741819,
                43.91161023630775
                ],
                [
                12.910353088199289,
                43.911611136999454
                ],
                [
                12.910378292566863,
                43.91161383040051
                ],
                [
                12.910403009114908,
                43.91161829057221
                ],
                [
                12.910426999811587,
                43.911624474561066
                ],
                [
                12.91045003361516,
                43.91163232281242
                ],
                [
                12.91047188869896,
                43.91164175974393
                ],
                [
                12.910492354587674,
                43.911652694473574
                ],
                [
                12.910511234184277,
                43.911665021694674
                ],
                [
                12.910528345668155,
                43.91167862269019
                ],
                [
                12.910543524246139,
                43.911693366475944
                ],
                [
                12.910556623739557,
                43.91170911106198
                ],
                [
                12.910567517992042,
                43.911725704820086
                ],
                [
                12.910576102084525,
                43.91174298794393
                ],
                [
                12.910582293345723,
                43.91176079398813
                ],
                [
                12.910586032148371,
                43.911778951471106
                ],
                [
                12.910587282483556,
                43.911797285526625
                ],
                [
                12.910586032307574,
                43.9118156195878
                ],
                [
                12.910582293658006,
                43.911833777087494
                ],
                [
                12.910576102537892,
                43.91185158315885
                ],
                [
                12.910567518569069,
                43.911868866319246
                ],
                [
                12.910556624418069,
                43.9118854601219
                ],
                [
                12.91054352500006,
                43.911901204758756
                ],
                [
                12.910528346468512,
                43.91191594859965
                ],
                [
                12.910511235000314,
                43.91192954965252
                ],
                [
                12.910492355388035,
                43.91194187693096
                ],
                [
                12.910471889452882,
                43.911952811715736
                ],
                [
                12.910450034293667,
                43.911962248698075
                ],
                [
                12.910427000388616,
                43.91197009699397
                ],
                [
                12.910403009568276,
                43.91197628101937
                ],
                [
                12.910378292879148,
                43.91198074121824
                ],
                [
                12.91035308835849,
                43.91198343463602
                ],
                [
                12.910327638741819,
                43.91198433533337
                ]
        ]]);

        const voce_narrante_1 = turf.polygon([[
        [
              12.910370330748522,
              43.91225297029264
            ],
            [
              12.910308873773516,
              43.91225079524489
            ],
            [
              12.910248008676149,
              43.91224429104899
            ],
            [
              12.910188321633427,
              43.91223352034531
            ],
            [
              12.91013038747605,
              43.91221858686392
            ],
            [
              12.910074764152007,
              43.91219963442545
            ],
            [
              12.910021987352838,
              43.91217684555599
            ],
            [
              12.9099725653543,
              43.91215043972909
            ],
            [
              12.909926974121156,
              43.91212067125191
            ],
            [
              12.90988565272322,
              43.912087826815984
            ],
            [
              12.909848999106826,
              43.91205222273601
            ],
            [
              12.909817366262436,
              43.91201420190335
            ],
            [
              12.909791058825306,
              43.91197413048369
            ],
            [
              12.909770330141908,
              43.91193239439044
            ],
            [
              12.909755379830413,
              43.91188939556806
            ],
            [
              12.909746351858649,
              43.91184554812101
            ],
            [
              12.909743333158064,
              43.911801274325555
            ],
            [
              12.909746352787023,
              43.91175700056305
            ],
            [
              12.909755381651484,
              43.91171315321353
            ],
            [
              12.909770332785692,
              43.91167015454956
            ],
            [
              12.909791062190205,
              43.91162841866948
            ],
            [
              12.90981737021914,
              43.911588347509564
            ],
            [
              12.909849003503279,
              43.911550326973256
            ],
            [
              12.90988565739047,
              43.91151472321482
            ],
            [
              12.909926978879842,
              43.91148187911331
            ],
            [
              12.90997257002155,
              43.91145211097054
            ],
            [
              12.910021991749291,
              43.91142570546519
            ],
            [
              12.91007476810871,
              43.91140291689207
            ],
            [
              12.910130390840951,
              43.91138396471335
            ],
            [
              12.91018832427721,
              43.911369031445126
            ],
            [
              12.910248010497218,
              43.911358260899846
            ],
            [
              12.91030887470189,
              43.91135175680151
            ],
            [
              12.910370330748522,
              43.91134958178667
            ],
            [
              12.91043178679515,
              43.91135175680151
            ],
            [
              12.910492650999824,
              43.911358260899846
            ],
            [
              12.91055233721983,
              43.911369031445126
            ],
            [
              12.910610270656091,
              43.91138396471335
            ],
            [
              12.910665893388332,
              43.91140291689207
            ],
            [
              12.910718669747753,
              43.91142570546519
            ],
            [
              12.910768091475495,
              43.91145211097054
            ],
            [
              12.9108136826172,
              43.91148187911331
            ],
            [
              12.910855004106573,
              43.91151472321482
            ],
            [
              12.910891657993764,
              43.911550326973256
            ],
            [
              12.910923291277904,
              43.911588347509564
            ],
            [
              12.910949599306837,
              43.91162841866948
            ],
            [
              12.910970328711349,
              43.91167015454956
            ],
            [
              12.910985279845558,
              43.91171315321353
            ],
            [
              12.91099430871002,
              43.91175700056305
            ],
            [
              12.91099732833898,
              43.911801274325555
            ],
            [
              12.910994309638394,
              43.91184554812101
            ],
            [
              12.91098528166663,
              43.91188939556806
            ],
            [
              12.910970331355134,
              43.91193239439044
            ],
            [
              12.910949602671737,
              43.91197413048369
            ],
            [
              12.910923295234603,
              43.91201420190335
            ],
            [
              12.910891662390217,
              43.91205222273601
            ],
            [
              12.910855008773822,
              43.912087826815984
            ],
            [
              12.910813687375889,
              43.91212067125191
            ],
            [
              12.910768096142743,
              43.91215043972909
            ],
            [
              12.910718674144205,
              43.91217684555599
            ],
            [
              12.910665897345035,
              43.91219963442545
            ],
            [
              12.910610274020991,
              43.91221858686392
            ],
            [
              12.910552339863614,
              43.91223352034531
            ],
            [
              12.910492652820894,
              43.91224429104899
            ],
            [
              12.910431787723525,
              43.91225079524489
            ],
            [
              12.910370330748522,
              43.91225297029264
            ]
        ]]);

        const voce_narrante_2 = turf.polygon([[
        [
              12.911676576529743,
              43.91297795032471
            ],
            [
              12.911593844470984,
              43.912975022350125
            ],
            [
              12.911511909191407,
              43.91296626662523
            ],
            [
              12.911431559795835,
              43.912951767475
            ],
            [
              12.911353570114338,
              43.91293166453829
            ],
            [
              12.91127869124901,
              43.91290615142294
            ],
            [
              12.911207644339687,
              43.912875473841005
            ],
            [
              12.91114111361843,
              43.91283992724205
            ],
            [
              12.911079739819517,
              43.91279985396768
            ],
            [
              12.911024114008564,
              43.91275563995415
            ],
            [
              12.910974771890155,
              43.912707711015315
            ],
            [
              12.910932188648793,
              43.91265652874143
            ],
            [
              12.9108967743729,
              43.91260258605352
            ],
            [
              12.910868870105867,
              43.912546402455924
            ],
            [
              12.910848744562218,
              43.91248851903298
            ],
            [
              12.910836591540473,
              43.91242949323781
            ],
            [
              12.91083252805758,
              43.912369893523646
            ],
            [
              12.910836593222879,
              43.91231029386916
            ],
            [
              12.910848747862373,
              43.912251268250756
            ],
            [
              12.910868874896948,
              43.91219338511486
            ],
            [
              12.910896780470791,
              43.912137201903576
            ],
            [
              12.910932195819154,
              43.91208325968638
            ],
            [
              12.91097477985743,
              43.91203207794953
            ],
            [
              12.911024122466578,
              43.9119841495934
            ],
            [
              12.911079748443234,
              43.91193993618589
            ],
            [
              12.911141122076447,
              43.91189986351751
            ],
            [
              12.911207652306965,
              43.911864317501276
            ],
            [
              12.911278698419368,
              43.911833640456365
            ],
            [
              12.91135357621223,
              43.91180812781174
            ],
            [
              12.911431564586916,
              43.91178802526133
            ],
            [
              12.91151191249156,
              43.91177352639814
            ],
            [
              12.91159384615339,
              43.91176477085001
            ],
            [
              12.911676576529743,
              43.91176184293512
            ],
            [
              12.911759306906095,
              43.91176477085001
            ],
            [
              12.911841240567925,
              43.91177352639814
            ],
            [
              12.91192158847257,
              43.91178802526133
            ],
            [
              12.911999576847256,
              43.91180812781174
            ],
            [
              12.912074454640118,
              43.911833640456365
            ],
            [
              12.912145500752521,
              43.911864317501276
            ],
            [
              12.912212030983039,
              43.91189986351751
            ],
            [
              12.91227340461625,
              43.91193993618589
            ],
            [
              12.912329030592906,
              43.9119841495934
            ],
            [
              12.912378373202053,
              43.91203207794953
            ],
            [
              12.91242095724033,
              43.91208325968638
            ],
            [
              12.912456372588695,
              43.912137201903576
            ],
            [
              12.912484278162538,
              43.91219338511486
            ],
            [
              12.912504405197113,
              43.912251268250756
            ],
            [
              12.912516559836607,
              43.91231029386916
            ],
            [
              12.912520625001903,
              43.912369893523646
            ],
            [
              12.91251656151901,
              43.91242949323781
            ],
            [
              12.912504408497268,
              43.91248851903298
            ],
            [
              12.912484282953619,
              43.912546402455924
            ],
            [
              12.912456378686585,
              43.91260258605352
            ],
            [
              12.91242096441069,
              43.91265652874143
            ],
            [
              12.912378381169331,
              43.912707711015315
            ],
            [
              12.91232903905092,
              43.91275563995415
            ],
            [
              12.91227341323997,
              43.91279985396768
            ],
            [
              12.912212039441055,
              43.91283992724205
            ],
            [
              12.912145508719796,
              43.912875473841005
            ],
            [
              12.912074461810475,
              43.91290615142294
            ],
            [
              12.911999582945144,
              43.91293166453829
            ],
            [
              12.911921593263651,
              43.912951767475
            ],
            [
              12.911841243868079,
              43.91296626662523
            ],
            [
              12.911759308588499,
              43.912975022350125
            ],
            [
              12.911676576529743,
              43.91297795032471
            ]
        ]]);

        const campo_visivo_facciata = turf.polygon([[
            [
              12.9103023461914,
              43.91178338565766
            ],
            [
              12.910280702050613,
              43.9117826196395
            ],
            [
              12.910259266356393,
              43.911780328962244
            ],
            [
              12.910238245547783,
              43.91177653568655
            ],
            [
              12.910217842068135,
              43.911771276344005
            ],
            [
              12.9101982524154,
              43.91176460158535
            ],
            [
              12.910179665249697,
              43.91175657569261
            ],
            [
              12.910162259576378,
              43.91174727596005
            ],
            [
              12.91014620302208,
              43.911736791949764
            ],
            [
              12.910131650220354,
              43.91172522462909
            ],
            [
              12.910118741322481,
              43.91171268539825
            ],
            [
              12.910107600647715,
              43.91169929501747
            ],
            [
              12.910098335486058,
              43.911685182443954
            ],
            [
              12.910091035065031,
              43.91167048358998
            ],
            [
              12.910085769690385,
              43.9116553400139
            ],
            [
              12.910082590069088,
              43.911639897556945
            ],
            [
              12.910081526821038,
              43.91162430493858
            ],
            [
              12.910082590184237,
              43.911608712324295
            ],
            [
              12.910085769916257,
              43.91159326987943
            ],
            [
              12.910091035392949,
              43.911578126323015
            ],
            [
              12.910098335903422,
              43.91156342749547
            ],
            [
              12.91010760113848,
              43.91154931495417
            ],
            [
              12.910118741867791,
              43.91153592461015
            ],
            [
              12.910131650799254,
              43.911523385419194
            ],
            [
              12.910146203612317,
              43.91151181813999
            ],
            [
              12.910162260155278,
              43.911501334171184
            ],
            [
              12.910179665795008,
              43.91149203447852
            ],
            [
              12.910198252906165,
              43.91148400862253
            ],
            [
              12.9102178424855,
              43.911477333896094
            ],
            [
              12.910238245875702,
              43.91147207457999
            ],
            [
              12.910259266582267,
              43.91146828132394
            ],
            [
              12.910280702165764,
              43.91146599065879
            ],
            [
              12.9103023461914,
              43.911465224644715
            ],
            [
              12.910323990217037,
              43.91146599065879
            ],
            [
              12.910345425800536,
              43.91146828132394
            ],
            [
              12.9103664465071,
              43.91147207457999
            ],
            [
              12.910386849897304,
              43.911477333896094
            ],
            [
              12.910406439476635,
              43.91148400862253
            ],
            [
              12.910425026587795,
              43.91149203447852
            ],
            [
              12.910442432227523,
              43.911501334171184
            ],
            [
              12.910458488770482,
              43.91151181813999
            ],
            [
              12.910473041583547,
              43.911523385419194
            ],
            [
              12.910485950515008,
              43.91153592461015
            ],
            [
              12.91049709124432,
              43.91154931495417
            ],
            [
              12.91050635647938,
              43.91156342749547
            ],
            [
              12.910513656989853,
              43.911578126323015
            ],
            [
              12.910518922466544,
              43.91159326987943
            ],
            [
              12.910522102198565,
              43.911608712324295
            ],
            [
              12.910523165561763,
              43.91162430493858
            ],
            [
              12.910522102313713,
              43.911639897556945
            ],
            [
              12.910518922692418,
              43.9116553400139
            ],
            [
              12.91051365731777,
              43.91167048358998
            ],
            [
              12.910506356896743,
              43.911685182443954
            ],
            [
              12.910497091735087,
              43.91169929501747
            ],
            [
              12.91048595106032,
              43.91171268539825
            ],
            [
              12.910473042162446,
              43.91172522462909
            ],
            [
              12.910458489360723,
              43.911736791949764
            ],
            [
              12.910442432806423,
              43.91174727596005
            ],
            [
              12.910425027133106,
              43.91175657569261
            ],
            [
              12.910406439967401,
              43.91176460158535
            ],
            [
              12.910386850314666,
              43.911771276344005
            ],
            [
              12.910366446835019,
              43.91177653568655
            ],
            [
              12.91034542602641,
              43.911780328962244
            ],
            [
              12.91032399033219,
              43.9117826196395
            ],
            [
              12.9103023461914,
              43.91178338565766
            ]
        ]]);

        const campo_visivo_laterale = turf.polygon([[
            [
              12.91024463229715,
              43.912072099835946
            ],
            [
              12.910225480683758,
              43.91207142203542
            ],
            [
              12.910206513512172,
              43.91206939516142
            ],
            [
              12.910187913447869,
              43.91206603873402
            ],
            [
              12.910169859620783,
              43.912061385077656
            ],
            [
              12.910152525900155,
              43.9120554790099
            ],
            [
              12.910136079220013,
              43.91204837740976
            ],
            [
              12.910120677971491,
              43.91204014866995
            ],
            [
              12.910106470477414,
              43.91203087203819
            ],
            [
              12.910093593563841,
              43.91202063685396
            ],
            [
              12.910082171242363,
              43.91200954168816
            ],
            [
              12.9100723135158,
              43.91199769339375
            ],
            [
              12.910064115318836,
              43.911985206076686
            ],
            [
              12.910057655603758,
              43.91197219999704
            ],
            [
              12.910052996580147,
              43.91195880041075
            ],
            [
              12.910050183115793,
              43.91194513636341
            ],
            [
              12.910049242304652,
              43.911931339447364
            ],
            [
              12.91005018320595,
              43.911917542534525
            ],
            [
              12.910052996756994,
              43.91190387849664
            ],
            [
              12.910057655860502,
              43.911890478925734
            ],
            [
              12.910064115645607,
              43.91187747286679
            ],
            [
              12.910072313900045,
              43.911864985574965
            ],
            [
              12.910082171669313,
              43.911853137309336
            ],
            [
              12.91009359401709,
              43.91184204217475
            ],
            [
              12.910106470939542,
              43.911831807023
            ],
            [
              12.91012067842474,
              43.911822530423706
            ],
            [
              12.910136079646962,
              43.911814301715125
            ],
            [
              12.9101525262844,
              43.91180720014376
            ],
            [
              12.910169859947557,
              43.911801294101224
            ],
            [
              12.910187913704611,
              43.911796640465575
            ],
            [
              12.910206513689019,
              43.91179328405355
            ],
            [
              12.910225480773914,
              43.91179125718902
            ],
            [
              12.91024463229715,
              43.9117905793917
            ],
            [
              12.910263783820387,
              43.91179125718902
            ],
            [
              12.910282750905282,
              43.91179328405355
            ],
            [
              12.91030135088969,
              43.911796640465575
            ],
            [
              12.910319404646744,
              43.911801294101224
            ],
            [
              12.910336738309901,
              43.91180720014376
            ],
            [
              12.91035318494734,
              43.911814301715125
            ],
            [
              12.910368586169561,
              43.911822530423706
            ],
            [
              12.91038279365476,
              43.911831807023
            ],
            [
              12.910395670577213,
              43.91184204217475
            ],
            [
              12.910407092924986,
              43.911853137309336
            ],
            [
              12.910416950694257,
              43.911864985574965
            ],
            [
              12.910425148948693,
              43.91187747286679
            ],
            [
              12.9104316087338,
              43.911890478925734
            ],
            [
              12.910436267837309,
              43.91190387849664
            ],
            [
              12.910439081388352,
              43.911917542534525
            ],
            [
              12.91044002228965,
              43.911931339447364
            ],
            [
              12.91043908147851,
              43.91194513636341
            ],
            [
              12.910436268014156,
              43.91195880041075
            ],
            [
              12.910431608990544,
              43.91197219999704
            ],
            [
              12.910425149275463,
              43.911985206076686
            ],
            [
              12.9104169510785,
              43.91199769339375
            ],
            [
              12.910407093351937,
              43.91200954168816
            ],
            [
              12.91039567103046,
              43.91202063685396
            ],
            [
              12.910382794116888,
              43.91203087203819
            ],
            [
              12.91036858662281,
              43.91204014866995
            ],
            [
              12.910353185374289,
              43.91204837740976
            ],
            [
              12.910336738694147,
              43.9120554790099
            ],
            [
              12.910319404973517,
              43.912061385077656
            ],
            [
              12.910301351146433,
              43.91206603873402
            ],
            [
              12.91028275108213,
              43.91206939516142
            ],
            [
              12.910263783910542,
              43.91207142203542
            ],
            [
              12.91024463229715,
              43.912072099835946
            ]
        ]]);

        const campo_visivo_retro = turf.polygon([[
            [
              12.910568718010325,
              43.91229277499889
            ],
            [
              12.910546956068421,
              43.912292004818404
            ],
            [
              12.910525403707586,
              43.912289701694256
            ],
            [
              12.910504268490456,
              43.91228588780696
            ],
            [
              12.910483753962206,
              43.91228059988665
            ],
            [
              12.910464057690263,
              43.91227388885925
            ],
            [
              12.910445369361558,
              43.912265819356094
            ],
            [
              12.910427868955706,
              43.91225646909143
            ],
            [
              12.910411725011674,
              43.912245928114025
            ],
            [
              12.910397093004635,
              43.91223429793985
            ],
            [
              12.910384113848645,
              43.91222169057445
            ],
            [
              12.910372912539584,
              43.912208227434206
            ],
            [
              12.910363596951388,
              43.91219403817707
            ],
            [
              12.910356256797199,
              43.912179259453794
            ],
            [
              12.910350962765405,
              43.91216403359197
            ],
            [
              12.910347765838946,
              43.91214850722526
            ],
            [
              12.910346696804359,
              43.912132829881216
            ],
            [
              12.910347765955356,
              43.9121171525413
            ],
            [
              12.910350962993748,
              43.91210162618681
            ],
            [
              12.9103562571287,
              43.91208640034485
            ],
            [
              12.910363597373312,
              43.9120716216483
            ],
            [
              12.910372913035712,
              43.91205743242374
            ],
            [
              12.91038411439991,
              43.91204396932065
            ],
            [
              12.910397093589856,
              43.91203136199557
            ],
            [
              12.910411725608364,
              43.912019731863325
            ],
            [
              12.910427869540928,
              43.91200919092785
            ],
            [
              12.910445369912823,
              43.91199984070351
            ],
            [
              12.91046405818639,
              43.91199177123752
            ],
            [
              12.91048375438413,
              43.91198506024267
            ],
            [
              12.910504268821956,
              43.911979772349085
            ],
            [
              12.910525403935932,
              43.91197595848166
            ],
            [
              12.910546956184827,
              43.91197365536974
            ],
            [
              12.910568718010325,
              43.91197288519338
            ],
            [
              12.910590479835822,
              43.91197365536974
            ],
            [
              12.91061203208472,
              43.91197595848166
            ],
            [
              12.910633167198693,
              43.911979772349085
            ],
            [
              12.910653681636521,
              43.91198506024267
            ],
            [
              12.910673377834259,
              43.91199177123752
            ],
            [
              12.910692066107826,
              43.91199984070351
            ],
            [
              12.91070956647972,
              43.91200919092785
            ],
            [
              12.910725710412288,
              43.912019731863325
            ],
            [
              12.910740342430794,
              43.91203136199557
            ],
            [
              12.910753321620739,
              43.91204396932065
            ],
            [
              12.910764522984937,
              43.91205743242374
            ],
            [
              12.910773838647339,
              43.9120716216483
            ],
            [
              12.910781178891948,
              43.91208640034485
            ],
            [
              12.910786473026901,
              43.91210162618681
            ],
            [
              12.910789670065295,
              43.9121171525413
            ],
            [
              12.91079073921629,
              43.912132829881216
            ],
            [
              12.910789670181703,
              43.91214850722526
            ],
            [
              12.910786473255245,
              43.91216403359197
            ],
            [
              12.91078117922345,
              43.912179259453794
            ],
            [
              12.910773839069261,
              43.91219403817707
            ],
            [
              12.910764523481065,
              43.912208227434206
            ],
            [
              12.910753322172006,
              43.91222169057445
            ],
            [
              12.910740343016016,
              43.91223429793985
            ],
            [
              12.910725711008975,
              43.912245928114025
            ],
            [
              12.910709567064943,
              43.91225646909143
            ],
            [
              12.910692066659093,
              43.912265819356094
            ],
            [
              12.910673378330388,
              43.91227388885925
            ],
            [
              12.910653682058443,
              43.91228059988665
            ],
            [
              12.910633167530195,
              43.91228588780696
            ],
            [
              12.910612032313063,
              43.912289701694256
            ],
            [
              12.910590479952228,
              43.912292004818404
            ],
            [
              12.910568718010325,
              43.91229277499889
            ]
        ]]);

        const campo_visivo_sara_levi = turf.polygon([[
            [
              12.912081996373985,
              43.91231421740446
            ],
            [
              12.912059913633835,
              43.91231343586934
            ],
            [
              12.912038043564266,
              43.91231109879071
            ],
            [
              12.91201659678767,
              43.91230722867605
            ],
            [
              12.911995779849756,
              43.912301862796994
            ],
            [
              12.911975793230356,
              43.91229505283029
            ],
            [
              12.911956829412642,
              43.91228686436011
            ],
            [
              12.911939071029364,
              43.912277376246465
            ],
            [
              12.911922689103962,
              43.912266679865674
            ],
            [
              12.911907841403504,
              43.91225487823032
            ],
            [
              12.911894670919292,
              43.91224208499727
            ],
            [
              12.911883304489784,
              43.912228423372916
            ],
            [
              12.911873851579092,
              43.91221402492674
            ],
            [
              12.911866403222817,
              43.912199028324125
            ],
            [
              12.911861031151357,
              43.912183577990945
            ],
            [
              12.911857787099168,
              43.91216782272266
            ],
            [
              12.911856702306586,
              43.91215191425128
            ],
            [
              12.911857787219033,
              43.91213600578416
            ],
            [
              12.911861031386481,
              43.91212025052846
            ],
            [
              12.911866403564163,
              43.912104800215744
            ],
            [
              12.911873852013546,
              43.91208980364065
            ],
            [
              12.911883305000647,
              43.912075405228
            ],
            [
              12.91189467148693,
              43.912061743641914
            ],
            [
              12.911907842006105,
              43.91204895045037
            ],
            [
              12.911922689718368,
              43.912037148858204
            ],
            [
              12.911939071631965,
              43.912026452520585
            ],
            [
              12.911956829980282,
              43.912016964448455
            ],
            [
              12.911975793741217,
              43.91200877601654
            ],
            [
              12.911995780284208,
              43.912001966083366
            ],
            [
              12.912016597129016,
              43.91199660023183
            ],
            [
              12.91203804379939,
              43.91199273013763
            ],
            [
              12.912059913753698,
              43.91199039307158
            ],
            [
              12.912081996373985,
              43.91198961154073
            ],
            [
              12.912104078994274,
              43.91199039307158
            ],
            [
              12.912125948948582,
              43.91199273013763
            ],
            [
              12.912147395618955,
              43.91199660023183
            ],
            [
              12.912168212463765,
              43.912001966083366
            ],
            [
              12.912188199006756,
              43.91200877601654
            ],
            [
              12.91220716276769,
              43.912016964448455
            ],
            [
              12.912224921116005,
              43.912026452520585
            ],
            [
              12.912241303029601,
              43.912037148858204
            ],
            [
              12.912256150741868,
              43.91204895045037
            ],
            [
              12.912269321261043,
              43.912061743641914
            ],
            [
              12.912280687747327,
              43.912075405228
            ],
            [
              12.912290140734427,
              43.91208980364065
            ],
            [
              12.912297589183808,
              43.912104800215744
            ],
            [
              12.912302961361492,
              43.91212025052846
            ],
            [
              12.91230620552894,
              43.91213600578416
            ],
            [
              12.912307290441385,
              43.91215191425128
            ],
            [
              12.912306205648806,
              43.91216782272266
            ],
            [
              12.912302961596616,
              43.912183577990945
            ],
            [
              12.912297589525156,
              43.912199028324125
            ],
            [
              12.91229014116888,
              43.91221402492674
            ],
            [
              12.912280688258189,
              43.912228423372916
            ],
            [
              12.912269321828681,
              43.91224208499727
            ],
            [
              12.912256151344469,
              43.91225487823032
            ],
            [
              12.912241303644011,
              43.912266679865674
            ],
            [
              12.91222492171861,
              43.912277376246465
            ],
            [
              12.91220716333533,
              43.91228686436011
            ],
            [
              12.912188199517615,
              43.91229505283029
            ],
            [
              12.912168212898218,
              43.912301862796994
            ],
            [
              12.912147395960304,
              43.91230722867605
            ],
            [
              12.912125949183704,
              43.91231109879071
            ],
            [
              12.912104079114139,
              43.91231343586934
            ],
            [
              12.912081996373985,
              43.91231421740446
            ]
        ]]);

        const campo_visivo_demolizione = turf.polygon([[
        [
              12.910530306717787,
              43.91261677690401
            ],
            [
              12.910508791907361,
              43.91261601547339
            ],
            [
              12.910487484297958,
              43.91261373851458
            ],
            [
              12.910466589095082,
              43.9126099679561
            ],
            [
              12.910446307532409,
              43.91260474011078
            ],
            [
              12.91042683493375,
              43.91259810532598
            ],
            [
              12.910408358831914,
              43.91259012749881
            ],
            [
              12.910391057162643,
              43.91258088346059
            ],
            [
              12.910375096550945,
              43.912570462237056
            ],
            [
              12.910360630706402,
              43.91255896419085
            ],
            [
              12.910347798942837,
              43.91254650005505
            ],
            [
              12.910336724836672,
              43.912533189866664
            ],
            [
              12.910327515036828,
              43.91251916181059
            ],
            [
              12.910320258237666,
              43.91250455098517
            ],
            [
              12.910315024324857,
              43.912489498100975
            ],
            [
              12.910311863702395,
              43.9124741481258
            ],
            [
              12.91031080680722,
              43.9124586488885
            ],
            [
              12.910311863816176,
              43.912443149655225
            ],
            [
              12.910315024548046,
              43.91242779969202
            ],
            [
              12.910320258561685,
              43.91241274682723
            ],
            [
              12.910327515449223,
              43.912398136027925
            ],
            [
              12.9103367253216,
              43.91238410800369
            ],
            [
              12.910347799481658,
              43.91237079785163
            ],
            [
              12.910360631278412,
              43.912358333755236
            ],
            [
              12.91037509713416,
              43.91234683575003
            ],
            [
              12.910391057734653,
              43.91233641456747
            ],
            [
              12.910408359370736,
              43.91232717056865
            ],
            [
              12.910426835418676,
              43.9123191927778
            ],
            [
              12.910446307944804,
              43.912312558024844
            ],
            [
              12.9104665894191,
              43.91230733020565
            ],
            [
              12.910487484521145,
              43.91230355966658
            ],
            [
              12.91050879202114,
              43.91230128271972
            ],
            [
              12.910530306717787,
              43.91230052129314
            ],
            [
              12.910551821414435,
              43.91230128271972
            ],
            [
              12.91057312891443,
              43.91230355966658
            ],
            [
              12.910594024016476,
              43.91230733020565
            ],
            [
              12.910614305490771,
              43.912312558024844
            ],
            [
              12.9106337780169,
              43.9123191927778
            ],
            [
              12.91065225406484,
              43.91232717056865
            ],
            [
              12.910669555700922,
              43.91233641456747
            ],
            [
              12.910685516301415,
              43.91234683575003
            ],
            [
              12.910699982157164,
              43.912358333755236
            ],
            [
              12.910712813953918,
              43.91237079785163
            ],
            [
              12.910723888113976,
              43.91238410800369
            ],
            [
              12.910733097986352,
              43.912398136027925
            ],
            [
              12.91074035487389,
              43.91241274682723
            ],
            [
              12.91074558888753,
              43.91242779969202
            ],
            [
              12.9107487496194,
              43.912443149655225
            ],
            [
              12.910749806628354,
              43.9124586488885
            ],
            [
              12.91074874973318,
              43.9124741481258
            ],
            [
              12.910745589110716,
              43.912489498100975
            ],
            [
              12.910740355197907,
              43.91250455098517
            ],
            [
              12.910733098398746,
              43.91251916181059
            ],
            [
              12.910723888598904,
              43.912533189866664
            ],
            [
              12.910712814492738,
              43.91254650005505
            ],
            [
              12.910699982729174,
              43.91255896419085
            ],
            [
              12.910685516884628,
              43.912570462237056
            ],
            [
              12.910669556272932,
              43.91258088346059
            ],
            [
              12.910652254603662,
              43.91259012749881
            ],
            [
              12.910633778501825,
              43.91259810532598
            ],
            [
              12.910614305903167,
              43.91260474011078
            ],
            [
              12.910594024340494,
              43.9126099679561
            ],
            [
              12.910573129137617,
              43.91261373851458
            ],
            [
              12.910551821528214,
              43.91261601547339
            ],
            [
              12.910530306717787,
              43.91261677690401
            ]
        ]]);
        
        const campo_sonoro_sara_levi = turf.polygon([[
            [
              12.912077667639892,
              43.91238407429773
            ],
            [
              12.912045992938491,
              43.91238295329282
            ],
            [
              12.912014623285334,
              43.912379601074086
            ],
            [
              12.91198386079074,
              43.912374049925596
            ],
            [
              12.911954001717495,
              43.912366353308585
            ],
            [
              12.911925333627556,
              43.912356585346465
            ],
            [
              12.911898132612565,
              43.91234484011106
            ],
            [
              12.911872660634849,
              43.91233123071653
            ],
            [
              12.911849163004508,
              43.912315888230026
            ],
            [
              12.911827866016926,
              43.91229896040935
            ],
            [
              12.911808974773379,
              43.91228061027994
            ],
            [
              12.911792671205838,
              43.91226101456483
            ],
            [
              12.911779112324885,
              43.912240361982576
            ],
            [
              12.91176842870769,
              43.91221885142984
            ],
            [
              12.911760723240578,
              43.91219669006582
            ],
            [
              12.91175607012825,
              43.91217409131717
            ],
            [
              12.911754514179314,
              43.91215127282256
            ],
            [
              12.91175607037486,
              43.91212845433671
            ],
            [
              12.91176072372432,
              43.912105855613966
            ],
            [
              12.911768429409978,
              43.91208369429203
            ],
            [
              12.911779113218726,
              43.91206218379591
            ],
            [
              12.911792672256883,
              43.912041531282654
            ],
            [
              12.911808975941241,
              43.912021935646266
            ],
            [
              12.911827867256722,
              43.91200358560228
            ],
            [
              12.911849164268595,
              43.91198665787043
            ],
            [
              12.911872661874641,
              43.911971315472755
            ],
            [
              12.911898133780426,
              43.91195770616364
            ],
            [
              12.911925334678603,
              43.91194596100695
            ],
            [
              12.911954002611337,
              43.91193619311383
            ],
            [
              12.911983861493027,
              43.911928496553436
            ],
            [
              12.912014623769078,
              43.911922945447024
            ],
            [
              12.912045993185101,
              43.91191959325421
            ],
            [
              12.912077667639892,
              43.911918472258044
            ],
            [
              12.91210934209468,
              43.91191959325421
            ],
            [
              12.912140711510705,
              43.911922945447024
            ],
            [
              12.912171473786756,
              43.911928496553436
            ],
            [
              12.912201332668445,
              43.91193619311383
            ],
            [
              12.912230000601179,
              43.91194596100695
            ],
            [
              12.912257201499358,
              43.91195770616364
            ],
            [
              12.91228267340514,
              43.911971315472755
            ],
            [
              12.912306171011188,
              43.91198665787043
            ],
            [
              12.912327468023062,
              43.91200358560228
            ],
            [
              12.91234635933854,
              43.912021935646266
            ],
            [
              12.912362663022899,
              43.912041531282654
            ],
            [
              12.912376222061058,
              43.91206218379591
            ],
            [
              12.912386905869804,
              43.91208369429203
            ],
            [
              12.912394611555465,
              43.912105855613966
            ],
            [
              12.91239926490492,
              43.91212845433671
            ],
            [
              12.912400821100467,
              43.91215127282256
            ],
            [
              12.912399265151533,
              43.91217409131717
            ],
            [
              12.912394612039208,
              43.91219669006582
            ],
            [
              12.912386906572092,
              43.91221885142984
            ],
            [
              12.912376222954899,
              43.912240361982576
            ],
            [
              12.912362664073946,
              43.91226101456483
            ],
            [
              12.912346360506403,
              43.91228061027994
            ],
            [
              12.912327469262857,
              43.91229896040935
            ],
            [
              12.912306172275274,
              43.912315888230026
            ],
            [
              12.912282674644937,
              43.91233123071653
            ],
            [
              12.912257202667218,
              43.91234484011106
            ],
            [
              12.91223000165223,
              43.912356585346465
            ],
            [
              12.91220133356229,
              43.912366353308585
            ],
            [
              12.912171474489043,
              43.912374049925596
            ],
            [
              12.91214071199445,
              43.912379601074086
            ],
            [
              12.91210934234129,
              43.91238295329282
            ],
            [
              12.912077667639892,
              43.91238407429773
            ]
        ]]);
        
        const campo_sonoro_demolizione = turf.polygon([[
            [
              12.91118374595905,
              43.91284324867967
            ],
            [
              12.911153626399509,
              43.912842182721306
            ],
            [
              12.911123796911003,
              43.91283899511209
            ],
            [
              12.911094544770899,
              43.91283371655078
            ],
            [
              12.911066151696144,
              43.91282639787336
            ],
            [
              12.911038891130062,
              43.912817109563406
            ],
            [
              12.911013025608854,
              43.91280594107335
            ],
            [
              12.91098880423315,
              43.91279299996288
            ],
            [
              12.910966460268975,
              43.912778410863055
            ],
            [
              12.910946208901235,
              43.91276231427605
            ],
            [
              12.910928245161355,
              43.91274486522196
            ],
            [
              12.910912742049035,
              43.91272623174581
            ],
            [
              12.910899848866197,
              43.912706593299205
            ],
            [
              12.910889689779196,
              43.912686139011996
            ],
            [
              12.910882362623099,
              43.912665065870904
            ],
            [
              12.910877937959576,
              43.91264357682236
            ],
            [
              12.910876458397475,
              43.912621878817966
            ],
            [
              12.91087793818257,
              43.91260018082148
            ],
            [
              12.91088236306051,
              43.912578691796355
            ],
            [
              12.910889690414223,
              43.912557618693306
            ],
            [
              12.910899849674431,
              43.91253716445731
            ],
            [
              12.910912742999415,
              43.912517526073096
            ],
            [
              12.910928246217365,
              43.912498892668125
            ],
            [
              12.910946210022288,
              43.912481443691256
            ],
            [
              12.910966461411991,
              43.91246534718458
            ],
            [
              12.910988805354203,
              43.91245075816507
            ],
            [
              12.911013026664861,
              43.91243781713183
            ],
            [
              12.911038892080443,
              43.912426648712966
            ],
            [
              12.911066152504377,
              43.912417360465405
            ],
            [
              12.911094545405923,
              43.91241004183917
            ],
            [
              12.911123797348415,
              43.91240476331591
            ],
            [
              12.9111536266225,
              43.91240157573013
            ],
            [
              12.91118374595905,
              43.91240050977967
            ],
            [
              12.911213865295599,
              43.91240157573013
            ],
            [
              12.911243694569684,
              43.91240476331591
            ],
            [
              12.911272946512177,
              43.91241004183917
            ],
            [
              12.911301339413722,
              43.912417360465405
            ],
            [
              12.911328599837656,
              43.912426648712966
            ],
            [
              12.911354465253238,
              43.91243781713183
            ],
            [
              12.911378686563896,
              43.91245075816507
            ],
            [
              12.911401030506111,
              43.91246534718458
            ],
            [
              12.911421281895812,
              43.912481443691256
            ],
            [
              12.911439245700738,
              43.912498892668125
            ],
            [
              12.911454748918684,
              43.912517526073096
            ],
            [
              12.911467642243672,
              43.91253716445731
            ],
            [
              12.911477801503878,
              43.912557618693306
            ],
            [
              12.911485128857588,
              43.912578691796355
            ],
            [
              12.911489553735532,
              43.91260018082148
            ],
            [
              12.911491033520628,
              43.912621878817966
            ],
            [
              12.911489553958523,
              43.91264357682236
            ],
            [
              12.911485129295,
              43.912665065870904
            ],
            [
              12.911477802138904,
              43.912686139011996
            ],
            [
              12.911467643051903,
              43.912706593299205
            ],
            [
              12.911454749869067,
              43.91272623174581
            ],
            [
              12.911439246756744,
              43.91274486522196
            ],
            [
              12.911421283016864,
              43.91276231427605
            ],
            [
              12.911401031649124,
              43.912778410863055
            ],
            [
              12.91137868768495,
              43.91279299996288
            ],
            [
              12.911354466309245,
              43.91280594107335
            ],
            [
              12.911328600788039,
              43.912817109563406
            ],
            [
              12.911301340221955,
              43.91282639787336
            ],
            [
              12.9112729471472,
              43.91283371655078
            ],
            [
              12.911243695007098,
              43.91283899511209
            ],
            [
              12.91121386551859,
              43.912842182721306
            ],
            [
              12.91118374595905,
              43.91284324867967
            ]
        ]]);
        
        var larghezza_contenitore;

        function adatta_larghezza(contenitore){
            larghezza_contenitore = $("." + contenitore).outerWidth();
	        $('.selector').css('width', larghezza_contenitore + 20); // 20 --> margini dx e sx del div attivo
        }
       
        // ------------------------------------------------------------------------------------------------------------------------------------------------ test mode

        const origin = [12.910316279411177, 43.91162447859239];

        var user_test = {
            'type': 'FeatureCollection',
            'features': [
                {
                    'type': 'Feature',
                    'properties': {},
                    'geometry': {
                        'type': 'Point',
                        'coordinates': origin
                    }
                }
            ]
        };

        // ------------------------------------------------------------------------------------------------------------------------------------------------ test mode

        let mouse = false;
        var mouse_pos = {};

        mapboxgl.accessToken = 'pk.eyJ1Ijoibmljb2xvc2luYXRyYSIsImEiOiJjbGs4ZTd0aWowaXNqM2ZybzEzYmplaGF3In0.zJYGpj2MF2Nw8M8XHuXc8Q';
        let map_navigazione = new mapboxgl.Map({
            container: 'map_navigazione', // container ID
            style: 'mapbox://styles/nicolosinatra/clmnjwye901wi01r4h6n9fekx', // style URL
            center: [12.909, 43.909],
            zoom: 15.3
        });

        var NavigationControl = new mapboxgl.NavigationControl({
            showCompass: true,
            showZoom: false
        })

        // Add zoom and rotation controls to the map.
        map_navigazione.addControl(NavigationControl);

        const directions = new MapboxDirections({
            accessToken: mapboxgl.accessToken,
            profile: 'mapbox/walking',
            controls: {
                profileSwitcher: false,
                inputs: false,
                instructions: false,
            },
            language: 'it-IT',
            interactive: false,
            unit: 'metric',
            flyTo: false
            // profile: 'mapbox/cycling'
            });

        map_navigazione.addControl(directions);


        const geolocate = new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
            },
            // When active the map will receive updates to the device's location as it changes.
            trackUserLocation: true,
            // Draw an arrow next to the location dot to indicate which direction the device is heading.
            showUserHeading: true
        });
        // Add the control to the map.
        map_navigazione.addControl(geolocate);

        // definire stile del navigatore
        map_navigazione.on('load',  function() {
            map_navigazione.setLayoutProperty('nomi-economia-corporativa', 'visibility', 'visible');
            map_navigazione.setLayoutProperty('icone-economia-corporativa', 'visibility', 'visible');
            map_navigazione.moveLayer('icone-economia-corporativa');
            map_navigazione.moveLayer('nomi-economia-corporativa');

            map_navigazione.setPaintProperty('directions-route-line-alt', 'line-color', '#fff500');

            map_navigazione.setPaintProperty('directions-route-line-casing', 'line-color', '#000');
            map_navigazione.setPaintProperty('directions-route-line-casing', 'line-width', 6);
            
            map_navigazione.setPaintProperty('directions-route-line', 'line-color', '#fff500');
            map_navigazione.setPaintProperty('directions-route-line', 'line-width', 4);


            map_navigazione.setLayoutProperty('directions-hover-point-casing', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-hover-point', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-waypoint-point-casing', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-waypoint-point', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-origin-point', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-origin-label', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-destination-point', 'visibility', 'none');
            map_navigazione.setLayoutProperty('directions-destination-label', 'visibility', 'none');

            geolocate.trigger();

            directions.setDestination([destinazione.longitude, destinazione.latitude]); 

            id_posizione_aggiornata = navigator.geolocation.watchPosition(success, error, options); 


            // ------------------------------------------------------------------------------------------------------------------------------------------------ test mode

            //  <------ add questo per disattivare

            map_navigazione.loadImage('https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Cat_silhouette.svg/400px-Cat_silhouette.svg.png', (error, image) => {
                if (error) throw error;
                if (!map.hasImage('cat')) map.addImage('cat', image);
            });

            map_navigazione.addSource('point', {
                'type': 'geojson',
                'data': user_test
            });

            // rende visibile il punto creato definendone lo stile sulla mappa (cat)
            map_navigazione.addLayer({
            'id': 'point',
            'source': 'point',
            'type': 'symbol',
            'layout': {
                // This icon is a part of the Mapbox Streets style.
                // To view all images available in a Mapbox style, open
                // the style in Mapbox Studio and click the "Images" tab.
                // To add a new image to the style at runtime see
                // https://docs.mapbox.com/mapbox-gl-js/example/add-image/
                'icon-image': 'cat',
                'icon-size': 0.1,
                'icon-rotate': ['get', 'bearing'],
                'icon-rotation-alignment': 'map',
                'icon-allow-overlap': true,
                'icon-ignore-placement': true
            }
            });

            document.getElementById('mouse').addEventListener('click', () => {
                if (mouse){
                    mouse = false;
                    $('#mouse').removeClass('active');
                } else {
                    mouse = true;
                    $('#mouse').addClass('active');
                }
            });


            map_navigazione.on('mousemove', (e) => {
                const json = JSON.stringify(e.lngLat.wrap());
                const json_obj = JSON.parse(json);
                mouse_pos = json_obj;
                let mouse_lat = mouse_pos.lat;
                let mouse_lng = mouse_pos.lng;
                // `e.point` is the x, y coordinates of the `mousemove` event
                // relative to the top-left corner of the map.
                // document.getElementById('info').innerHTML = JSON.stringify(e.lngLat.wrap()) + JSON.stringify(e.point);

                if (mouse){
                    user_test.features[0].geometry.coordinates = [mouse_lng, mouse_lat];
                    // Update the source with this new data
                    map_navigazione.getSource('point').setData(user_test);

                    let user_lng = mouse_lng;
                    let user_lat = mouse_lat;
                    
                    // Verificare se e dentro quale campo sonoro si trova l'utente
                    let user_turf = turf.point([parseFloat(user_lng), parseFloat(user_lat)]);
                    // console.log("user dentro:"+ turf.booleanPointInPolygon(user_turf, campo_sonoro_fronte_economia_corporativa));
                
                    if(turf.booleanPointInPolygon(user_turf, area_destinazione)){
                        console.log('sei_arrivato');
                        $('.destinazione_raggiunta').removeClass('not-visible');
                    }else{
                       
                    }
                }
            });

            // add questo per disattivare  ------> 

           // ------------------------------------------------------------------------------------------------------------------------------------------------ test mode


        })


        // hacky workaround for the fact that mapbox doesn't let you disable camera auto-tracking ------------------------------------------------- da capire
        geolocate._updateCamera = () => {}
        map_navigazione.addControl(geolocate)


        // solo la prima volta o quando utente clicca bussola
        //map_navigazione.setCenter([user_lng, user_lat]);
        $('.mapboxgl-ctrl').click(function(){
            map_navigazione.setCenter([user_lng, user_lat]);
        });

        var check_direction = false;

        function success(pos) {
            const user_crd = pos.coords;
            user_lng = user_crd.longitude;
            user_lat = user_crd.latitude;
        
           

            console.log("Your current position is:");
            console.log("Latitude : " + user_lat);
            console.log(`Longitude: ${user_lng}`);
            console.log(`More or less ${user_crd.accuracy} meters.`);

            // solo la prima volta o quando utente clicca bussola
            if ((user_lng != NaN) && (user_lat != NaN) && check_direction === false){
                directions.setOrigin([user_lng, user_lat]);
                check_direction = true;
            }
            

            if (check && stato_indicazioni === 'walking'){
                data_directions = directions._store.getState();
                tempo_a_piedi = Math.round(data_directions.directions[0].duration / 60);
                
                var tempo_in_bici = Math.round(tempo_a_piedi/3);
                let tempo_in_monopattino = Math.round(tempo_a_piedi/4);

                $('.duration-walking').text(tempo_a_piedi + 'min');
                $('.duration-cycling').text(tempo_in_bici + 'min');
                $('.duration-scooter').text(tempo_in_monopattino + 'min');

                adatta_larghezza('profile-indicazioni.active');
            }

            // ------------------------------------------------------- usare turf per verificare se sono ARRIVATO A DESTINAZIONE

            var user = turf.point([parseFloat(user_lng), parseFloat(user_lat)]);
            console.log("user dentro:"+ turf.booleanPointInPolygon(user, area_destinazione));
        
            if(turf.booleanPointInPolygon(user, area_destinazione)){
                jQuery(".dentro_fuori").text("arrivato, " + user_lng + ", "+ user_lat);
                $('.destinazione_raggiunta').removeClass('not-visible');
            }

            // -------------------------------------------------------- usare turf per attivare contenuti esperienza  ESPERIENZA

            if (check_destinazione){
                if(turf.booleanPointInPolygon(user, voce_narrante_1)){
                    jQuery(".dentro_fuori").text("voce narrante 1");
                }else if(turf.booleanPointInPolygon(user, voce_narrante_2)){
                    jQuery(".dentro_fuori").text("voce narrante 2");
                }else if(turf.booleanPointInPolygon(user, campo_visivo_facciata)){
                    jQuery(".dentro_fuori").text("campo visivo facciata");
                }else if(turf.booleanPointInPolygon(user, campo_visivo_facciata)){
                    jQuery(".dentro_fuori").text("campo visivo facciata");
                }
            }
           
        }
        
        function error(err) {
            console.error(`ERROR(${err.code}): ${err.message}`);
        }
        
        options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0,
        };

        var check = false;
        var tempo_a_piedi;
        var data_directions;
        // Set an event listener that fires
        // when the map is drawn to the screen.
        map_navigazione.on('idle', () => {

            data_directions = directions._store.getState();
            tempo_a_piedi = Math.round(data_directions.directions[0].duration / 60);

            if (tempo_a_piedi != undefined && check == false){
                var tempo_in_bici = Math.round(tempo_a_piedi/3);
                let tempo_in_monopattino = Math.round(tempo_a_piedi/4);

                $('.duration-walking').text(tempo_a_piedi + 'min');
                $('.duration-cycling').text(tempo_in_bici + 'min');
                $('.duration-scooter').text(tempo_in_monopattino + 'min');

                adatta_larghezza('profile-indicazioni.active');

                if(isNaN(tempo_a_piedi)){
                    check = false;
                }else{
                    check = true;
                }
            }
        });

        var stato_indicazioni = 'walking';
        
        $('.walking').click(function(){
            stato_indicazioni = 'walking';
            directions.actions.setProfile('mapbox/walking');
            $('.cycling').removeClass('active');
            $('.scooter').removeClass('active');
            
            $('.icone-indicazioni img').remove();
            $("<img>").attr("src", "img/cycle-man.svg")
                .addClass("cycle-man")
                .appendTo(".cycling-icon");
            $("<img>").attr("src", "img/scooter.svg")
                .addClass("scooter")
                .appendTo(".scooter-icon");


            anime({
                targets: '.selector',
                left: '0%',
                translateX: '0',
                duration: 200,
                easing: 'easeInOutQuad'
            });

            setTimeout(function(){
                $("<img>").attr("src", "img/walk-man-active.svg")
                .addClass("walk-man")
                .addClass("active")
                .appendTo(".walking-icon");
                
                $('.walking').addClass('active');
            }, 200);

            
            // $('.selector-container').css('justify-content', 'flex-start');

            adatta_larghezza('profile-indicazioni.walking');
        });

        $('.cycling').click(function(){
            stato_indicazioni = 'cycling';
            directions.actions.setProfile('mapbox/cycling');
            $('.walking').removeClass('active');
            $('.scooter').removeClass('active');

            $('.icone-indicazioni img').remove();
            $("<img>").attr("src", "img/walk-man.svg")
                .addClass("walk-man")
                .appendTo(".walking-icon");
            $("<img>").attr("src", "img/scooter.svg")
                .addClass("scooter")
                .appendTo(".scooter-icon");

            anime({
                targets: '.selector',
                left: '50%',
                translateX: '-50%',
                duration: 200,
                easing: 'easeInOutQuad'
            });

            setTimeout(function(){
                $("<img>").attr("src", "img/cycle-man-active.svg")
                .addClass("cycle-man")
                .addClass("active")
                .appendTo(".cycling-icon");
                
                $('.cycling').addClass('active');
            }, 200);

            adatta_larghezza('profile-indicazioni.cycling');
        });

        $('.scooter').click(function(){
            stato_indicazioni = 'scooter';
            directions.actions.setProfile('mapbox/cycling');
            $('.walking').removeClass('active');
            $('.cycling').removeClass('active');

            $('.icone-indicazioni img').remove();
            $("<img>").attr("src", "img/walk-man.svg")
                .addClass("walk-man")
                .appendTo(".walking-icon");
            $("<img>").attr("src", "img/cycle-man.svg")
                .addClass("cycle-man")
                .appendTo(".cycling-icon");

            anime({
                targets: '.selector',
                left: '100%',
                translateX: '-100%',
                duration: 200,
                easing: 'easeInOutQuad'
            });

            setTimeout(function(){
                $("<img>").attr("src", "img/scooter-active.svg")
                .addClass("scooter")
                .addClass("active")
                .appendTo(".scooter-icon");
                
                $('.scooter').addClass('active');
            }, 200);
            //$('.selector-container').css('justify-content', 'flex-end');

            adatta_larghezza('profile-indicazioni.scooter');
        });


        // INIZIA L'ESPERIENZA ---------------------------------------------------------------------------------------------------------

        $('.close-button-arrivato').click(function(){
            check_destinazione = true;
            $('.destinazione_raggiunta').fadeOut(500);
            $('.controls-profile-switcher').fadeOut(500);

            map_navigazione.setPaintProperty('directions-route-line-alt', 'line-opacity-transition', { duration: 300 });
            map_navigazione.setPaintProperty('directions-route-line-casing', 'line-opacity-transition', { duration: 100 });
            map_navigazione.setPaintProperty('directions-route-line', 'line-opacity-transition', { duration: 300 });

            map_navigazione.setPaintProperty('directions-route-line-alt', 'line-opacity', 0);
            map_navigazione.setPaintProperty('directions-route-line-casing', 'line-opacity', 0);
            map_navigazione.setPaintProperty('directions-route-line', 'line-opacity', 0);

            setTimeout(500, function(){
                $('.destinazione_raggiunta').addClass('not-visible');
                $('.controls-profile-switcher').addClass('not-visible');
            }); 
            
            map_navigazione.setPaintProperty('campi_interazione', 'fill-opacity-transition', { duration: 300 });
            map_navigazione.setPaintProperty('campi_interazione', 'fill-opacity', 1);
        });



       

       
    </script>
    
</body>
</html>